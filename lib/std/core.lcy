// Lency 标准库 - 核心模块 (core.lcy)
// 提供基础类型、Trait 和常用工具函数

// ============== 基础结构体 ==============

// Error 类型 - 用于 Result 错误处理
struct Error {
    string message
}

// Option 类型 - 用于表示可能存在的值
enum Option<T> {
    Some(T),
    None
}

// ============== 核心 Trait ==============

// Hash - 可哈希的类型
trait Hash {
    int hash();
}

// Eq - 可判断相等性的类型
trait Eq<T> {
    bool eq(T other);
    bool neq(T other);
}

// Comparable - 可比较的类型 (Generic)
trait Comparable<T> {
    bool less_than(T other);
    bool greater_than(T other);
}

// 为 int 实现 Hash
impl Hash for int {
    int hash() {
        return this
    }
}

// 为 int 实现 Eq
impl Eq<int> for int {
    bool eq(int other) {
        return this == other
    }
    bool neq(int other) {
        return this != other
    }
}

// 为 int 实现 Comparable
impl Comparable<int> for int {
    bool less_than(int other) {
        return this < other
    }
    bool greater_than(int other) {
        return this > other
    }
}

// 为 bool 实现 Hash
impl Hash for bool {
    int hash() {
        if this { return 1 }
        return 0
    }
}

// 为 bool 实现 Eq
impl Eq<bool> for bool {
    bool eq(bool other) {
        return this == other
    }
    bool neq(bool other) {
        return this != other
    }
}

// 为 string 实现 Hash
impl Hash for string {
    int hash() {
        var h = 5381
        var i = 0
        var l = len(this)
        while i < l {
            // djb2 hash: ((h << 5) + h) + c
            // Since we don't have bitwise operators yet, use * 33
            h = (h * 33) + this[i] // String Indexing!
            i = i + 1
        }
        return h
    }
}

// 为 string 实现 Eq
impl Eq<string> for string {
    bool eq(string other) {
        return this == other
    }
    bool neq(string other) {
        return this != other
    }
}


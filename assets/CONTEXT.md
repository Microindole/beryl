# Lency Project Context for AI Agents

> **DO NOT EDIT THIS FILE WITHOUT UPDATING `assets/design_spec.md` AND `assets/Lency.txt`**
> This file is intended to provide a high-level overview of the Lency project for AI assistants to quickly understand the context.

## 1. Project Overview
**Lency** is a statically typed, compiled programming language designed to be "Crystal Clear", "Safe by Default", and "Structurally Simple".
It combines the structural clarity of C-family languages with the development efficiency of modern languages like Go/Python, but without the runtime overhead (compiles to LLVM IR).

## 2. Core Philosophy (Non-negotiable)
Reference: [Lency.txt](./Lency.txt) & [design_spec.md](./design_spec.md)
1.  **Crystal Clear**: No hidden magic, implicit conversions, or complex metaprogramming.
2.  **Safety by Default**: Non-nullable types by default. Explicit `?` for nullables.
3.  **Structure over Style**: Braces `{}` are mandatory. Semicolons `;` are optional (omitted at line end).
4.  **Simplicity**: Composition over inheritance.

## 3. Architecture & Directory Structure

### Top Level
- `crates/`: Rust source code for the compiler components.
- `lib/`: Lency standard library (written in Lency).
- `tests/`: Integration tests (`.lcy` files).
- `scripts/`: Helper scripts for build, test, and maintenance.

### Compiler Components (`crates/`)
- **`lency_cli`**: Entry point, handles command-line arguments.
- **`lency_driver`**: Orchestrates the compilation phases.
- **`lency_syntax`**: Lexer and Parser. Produces AST.
- **`lency_sema`**: Semantic Analysis (Name resolution, Type inference, Null safety check).
- **`lency_monomorph`**: Monomorphization logic (Generic specialization). *Currently undergoing refactoring.*
- **`lency_codegen`**: LLVM IR generation.
- **`lency_runtime`**: Minimal runtime support (e.g., GC/allocator stubs, standard IO bindings).
- **`lency_diagnostics`**: Centralized error reporting (Diagnostic rendering).

## 4. Development Workflow

### Key Commands
- **Check Everything**: `./scripts/run_checks.sh` (Runs fmt, clippy, unit tests, lcy tests)
- **Run Unit Tests**: `cargo test`
- **Run Integration Tests**: `bash scripts/run_lcy_tests.sh`
- **Build**: `cargo build`

### Important Rules
1.  **Always compile**: Code must compile at the end of a task.
2.  **No TODO markers**: Finish what you start unless explicitly deferred.
3.  **Tests**: `tests/` contains `.lcy` files that `scripts/run_lcy_tests.sh` will compile and run.
    - `// @expect-error`: Marks a test that is expected to fail compilation (negative test).

## 5. Current Implementation Status
Reference: [status.md](./sprint_status.md) or [design_spec.md](./design_spec.md)
- **Basic Syntax**: ✅
- **Functions & Control Flow**: ✅
- **Structs & Traits**: ✅
- **Generics**: ✅ (Monomorphization impl)
- **Null Safety**: ✅ (Smart casts, `?.`, `??`)
- **Std Lib**: Partially implemented (Vector, String utils, File IO).

## 6. Common Pitfalls for AI
- **Semicolons**: Lency does NOT use semicolons at the end of lines, but uses braces `{}`.
- **Null safety**: Variables are non-nullable by default. usage of `T?` is required for null.
- **Generics**: Lency uses monomorphization. No runtime generics (like Java).

---
*Generated for AI Context - Keep Updated*
